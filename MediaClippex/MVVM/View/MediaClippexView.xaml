<moderncontrols:ModernWindow x:Class="MediaClippex.MVVM.View.MediaClippexView"
                             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                             xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
                             xmlns:moderncontrols="clr-namespace:org.russkyc.moderncontrols;assembly=Russkyc.ModernControls.WPF"
                             xmlns:system="clr-namespace:System;assembly=System.Runtime"
                             xmlns:components="clr-namespace:MediaClippex.Components"
                             mc:Ignorable="d"
                             Title="MediaClippex"
                             Height="700"
                             ExtendClientAreaToChrome="True"
                             Icon="../../Resources/Icon.ico"
                             TitleBarBackground="{DynamicResource bg-000}"
                             Background="{DynamicResource bg-000}"
                             WindowStartupLocation="CenterScreen"
                             Width="850">
    <Window.Resources>
        <system:Double x:Key="Shortest">130</system:Double>
        <system:Double x:Key="Short">200</system:Double>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Window.Resources>

    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Text="MediaClippex"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   FontWeight="Bold"
                   FontSize="26"
                   Margin="0 10 0 30"
                   Foreground="{DynamicResource fg-000}" />

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <moderncontrols:ModernTextBox
                x:Name="UrlTextBox"
                Grid.Column="0"
                HelperText="Required"
                Focusable="True"
                Placeholder="Enter a URL"
                Margin="0 5 2 5"
                LeftIcon="{materialIcons:MaterialIconExt Kind=Link}"
                Text="{Binding Url, UpdateSourceTrigger=PropertyChanged, NotifyOnValidationError=True}" />

            <moderncontrols:ModernButton
                Grid.Column="1"
                Width="{StaticResource Shortest}"
                Content="Resolve"
                FontSize="16"
                IconSize="20"
                Height="38"
                LeftCenterIcon="{materialIcons:MaterialIconExt Kind=Search}"
                Margin="0 5 0 0"
                VerticalAlignment="Top"
                Command="{Binding ResolveCommand}" />
        </Grid>

        <TextBlock Grid.Row="2"
                   Visibility="{Binding IsResolved, Converter={StaticResource BooleanToVisibilityConverter}}"
                   Margin="0 5"
                   Foreground="{DynamicResource danger}"
                   Text="{Binding Status}" />

        <!-- View preview -->
        <Grid Grid.Row="3" Visibility="{Binding ShowPreview, Converter={StaticResource BooleanToVisibilityConverter}}">
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup>
                    <VisualState x:Name="Visible">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames
                                Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                                <EasingDoubleKeyFrame KeyTime="0" Value="100" />
                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Collapsed">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames
                                Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                                <EasingDoubleKeyFrame KeyTime="0" Value="0" />
                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="100" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RenderTransform>
                <TranslateTransform />
            </Grid.RenderTransform>
            <components:VideoInfoCard />
        </Grid>

        <Grid Grid.Row="4" Margin="0 5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>


            <StackPanel Grid.Column="1" Margin="5 0">
                <TextBlock Text="Quality"
                           FontWeight="Medium"
                           Foreground="{DynamicResource fg-000}" Margin="0 0 0 5" />
                <moderncontrols:ModernComboBox ItemsSource="{Binding Qualities}"
                                               HorizontalAlignment="Left"
                                               SelectedItem="{Binding SelectedQuality}"
                                               Width="{StaticResource Short}"
                                               IsEnabled="{Binding IsResolved}" />
            </StackPanel>
            <moderncontrols:ModernSwitch HorizontalAlignment="Left"
                                         Content="Audio Only"
                                         VerticalAlignment="Bottom"
                                         Grid.Column="2" Margin="5 0"
                                         Width="{StaticResource Short}"
                                         IsChecked="{Binding IsAudioOnly}"
                                         IsEnabled="{Binding IsResolved}" />
            <Grid Grid.Column="3" HorizontalAlignment="Right">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <moderncontrols:ModernButton Content="Cancel"
                                             FontWeight="Heavy"
                                             Height="40"
                                             Width="130"
                                             IconSize="20"
                                             LeftCenterIcon="{materialIcons:MaterialIconExt Kind=Cancel}"
                                             IsEnabled="{Binding IsDownloading}"
                                             Command="{Binding CancelDownloadCommand}"
                                             VerticalAlignment="Bottom"
                                             DefaultBackground="{DynamicResource danger-lighten}"
                                             HoverBackground="{DynamicResource danger}"
                                             PressedBackground="{DynamicResource danger-darken}"
                                             DefaultForeground="{DynamicResource fg-200}" />
            </Grid>
        </Grid>

        <moderncontrols:ModernButton Grid.Row="5"
                                     Content="Download"
                                     FontSize="18"
                                     IconSize="24"
                                     FontWeight="Medium"
                                     LeftCenterIcon="{materialIcons:MaterialIconExt Kind=Download}"
                                     IsEnabled="{Binding IsResolved}"
                                     Margin="0 5 0 0"
                                     Command="{Binding DownloadCommand}"
                                     Foreground="{DynamicResource fg-000}" />

        <ProgressBar Grid.Row="6" Margin="0 5"
                     Value="{Binding Progress, Mode=OneWay}"
                     Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}"
                     IsIndeterminate="{Binding IsProgressIndeterminate}" Height="20">
            <ProgressBar.Style>
                <Style TargetType="ProgressBar">
                    <Setter Property="Foreground" Value="Blue" />
                    <Setter Property="Background" Value="LightGray" />
                    <Setter Property="BorderBrush" Value="Gray" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ProgressBar">
                                <Grid x:Name="PART_Track">
                                    <Rectangle x:Name="PART_Indicator" HorizontalAlignment="Left">
                                        <Rectangle.Fill>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="DodgerBlue" Offset="0" />
                                                <GradientStop Color="LightBlue" Offset="1" />
                                            </LinearGradientBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                    <TextBlock HorizontalAlignment="Center" 
                                               Foreground="{DynamicResource fg-000}"
                                               FontWeight="Medium"
                                               VerticalAlignment="Center" Text="{Binding ProgressInfo}" />
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ProgressBar.Style>
        </ProgressBar>

    </Grid>
</moderncontrols:ModernWindow>